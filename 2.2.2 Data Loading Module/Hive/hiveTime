SET hive.exec.dynamic.partition= true;
SET hive.exec.dynamic.partition.mode = nonstrict;

Drop Table if Exists CDW_SAPP_D_TIME_EXT;

CREATE EXTERNAL TABLE CDW_SAPP_D_TIME_EXT (TRANSACTIONID INT,
										   TIMEID STRING, 
										   DAY INT,
										   MONTH INT,
										   QUARTER STRING, 
										   YEAR INT)
ROW FORMAT DELIMITED FIELDS TERMINATED BY'\t'
LINES TERMINATED BY '\n'
LOCATION "/user/maria_dev/Credit_card_System/time";


CREATE TABLE IF NOT EXISTS CDW_SAPP_D_TIME (TRANSACTIONID INT,
							  TIMEID STRING, 
							  DAY INT,
							  MONTH INT, 
							  YEAR INT)
PARTITIONED BY(QUARTER STRING)
ROW FORMAT DELIMITED FIELDS TERMINATED BY'\t'
LINES TERMINATED BY '\n';


INSERT OVERWRITE TABLE CDW_SAPP_D_TIME
PARTITION (QUARTER)
SELECT TRANSACTIONID,
	   TIMEID, 
	   DAY,
	   MONTH,
	   YEAR,
	   QUARTER
FROM CDW_SAPP_D_TIME_EXT;